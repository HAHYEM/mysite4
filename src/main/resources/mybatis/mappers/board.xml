<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">
	
	<select id="getList" resultType="com.javaex.vo.BoardVo">
		<![CDATA[
			SELECT B.no, B.title, B.content, B.hit, B.reg_date regDate, B.user_no userNo, U.name userName
			FROM board B, users U
			WHERE B.user_no = U.no
			ORDER BY B.no asc
		]]>
	</select>
	
	<select id="getSearch" parameterType="map" resultType="com.javaex.vo.BoardVo">
		<![CDATA[
			SELECT no, title, content, hit, reg_date regDate, user_no userNo
			FROM board
			WHERE title like '%'||#{searchValue, jdbcType=VARCHAR}|| '%'
		]]>
	</select>
	
	<select id="paging" parameterType="int" resultType="com.javaex.vo.BoardVo">
		<![CDATA[
			SELECT *
			FROM (SELECT rownum rn, A.*
   				  FROM (SELECT B.no, B.title, B.content, B.hit, B.reg_date regDate, B.user_no userNo, U.name userName
            			FROM board B, users U
            			WHERE B.user_no = U.no) A
      			  ORDER BY rn)
			WHERE rownum < #{eachPage}
			AND rn > #{page} * #{eachPage}
		]]>
	</select>
	
	<insert id="writeByTitleContent" parameterType="com.javaex.vo.BoardVo">
		<![CDATA[
			INSERT INTO board
			VALUES (seq_board_no.nextval, #{title, jdbcType=VARCHAR}, #{content, jdbcType=VARCHAR}, 0, sysdate, #{userNo, jdbcType=INTEGER})
		]]>
	</insert>
	
	<select id="getArticle" parameterType="int" resultType="com.javaex.vo.BoardVo">
		<![CDATA[
			SELECT no, title, content, hit, reg_date regDate, user_no userNo
			FROM board
			WHERE no = #{no}
		]]>
	</select>
	
	<update id="hitUpdate" parameterType="int">
		<![CDATA[
			UPDATE board
			SET hit=hit+1
			WHERE no = #{no}
		]]>
	</update>
	
	<delete id="deleteNo" parameterType="int">
		<![CDATA[
			DELETE FROM board
			WHERE no = #{no}
		]]>
	</delete>
	
	<update id="updateContent" parameterType="com.javaex.vo.BoardVo">
		<![CDATA[
				UPDATE board
				SET title = #{title} 
					,content = #{content}
				WHERE no = #{no}
		]]>
	</update>
	
</mapper>